{% extends "layout.html"%}

{% block title %} Seleccionar Planilla {% endblock %}

{% block content %}
    
{% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        <ul class="list-unstyled">
        {% for category, message in messages %}
            <li class="alert alert-{{ category }}">{{ message }}</li>
        {% endfor %}
        </ul>
    {% endif %}
{% endwith %}

<div class="container mt-5">
    <h1 class="text-center mb-4">Seleccionar tipo de planilla</h1>
    <div class="form-container mx-auto">
        <form method="POST" id="form_select" class="mb-4">
            <div class="form-group mb-3">
                <label for="tipo_planilla">Seleccionar tipo de planilla:</label>
                <select id="tipo_planilla" name="tipo_planilla" class="form-control">
                    <option value="" disabled {% if not tipo_planilla %}selected{% endif %}>Seleccione un tipo</option>
                    <option value="cardiologico" {% if tipo_planilla == 'cardiologico' %}selected{% endif %}>Cardiol√≥gico</option>
                    <option value="politraumatizado" {% if tipo_planilla == 'politraumatizado' %}selected{% endif %}>Politraumatizado</option>
                </select>
            </div>

            <div class="form-group mb-3">
                <label for="buscar_nombre">Buscar por nombre:</label>
                <input type="text" id="buscar_nombre" name="buscar_nombre" value="{{ buscar_nombre }}" placeholder="Buscar nombre..." class="form-control">
            </div>
            
            <button type="submit" class="btn btn-primary">Ver Archivos</button>
        </form>
    </div>

    {% if tipo_planilla %}
    <div id="lista_planillas">
        <h2>Planillas guardadas:</h2>
        <ul id="archivos" class="list-group">
            {% if archivos %}
                {% for archivo in archivos %}
                    <li class="list-group-item"><a href="/ver_detalle_planilla/{{ tipo_planilla }}/{{ archivo }}">{{ archivo }}</a></li>
                {% endfor %}
            {% else %}
                <li class="list-group-item">No se encontraron formularios.</li>
            {% endif %}
        </ul>
    </div>
    {% endif %}

    <a href="{{ url_for('home') }}" class="btn btn-secondary mt-3">Volver</a>
</div>
{% endblock %}
